<!doctype html public "-//W3C//DTD HTML 3.2//RU">
<html>
<head>
   <title>Нормальные формы</title>
   
   
   
   
   
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>
<h4>4.5. Нормальные формы</h4>
<p align="justify">В п. <a href="4-4.htm">4.4</a> было дано определение первой нормальной формы (1НФ). Приведем здесь более строгое ее определение, а также определения других нормальных форм.</p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify">Таблица находится в <a name="normal"></a><i>первой нормальной форме</i> (<i>1НФ</i>) тогда и только тогда, когда ни одна из ее строк не содержит в любом своем поле более одного значения и ни одно из ее ключевых полей не пусто.</p>
</td></tr></table>
<p align="justify">Из таблиц, рассмотренных в п. 4, не удовлетворяет этим требованиям (т.е. не находится в 1НФ) только таблица рис. <a href="4-2.htm#pic4-1">4.1.</a> </p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify">Таблица находится во <i>второй нормальной форме</i> (<i>2НФ</i>), если она удовлетворяет определению 1НФ и все ее поля, не входящие в первичный ключ, связаны полной функциональной зависимостью с первичным ключом. </p>
</td></tr></table>
<p align="justify">Кроме таблицы рис. <a href="4-2.htm#pic4-1">4.1</a> не удовлетворяет этим требованиям только таблица <a href="4-2.htm#pic4-2">4.2.</a></p>
<p align="justify">Как обосновано ниже (пример <a href="4-6.htm#ex4-2">4.2</a>) она имеет составной первичный ключ</p>
<pre>
Блюдо, Дата_Р, Продукт, Поставщик, Город, Дата_П
</pre>
<p align="justify">и содержит множество неключевых полей (Вид, Рецепт, Порций, Калорийность и т.д.), зависящих лишь от той или иной части первичного ключа. Так поля Вид и Рецепт зависят только от поля Блюдо, Калорийность – от поля Продукт и т.п. Следовательно, эти поля не связаны с первичным ключом полной функциональной зависимостью.</p>
<p align="justify">Ко второй нормальной форме приведены почти все таблицы рис. <a href="4-3.htm#pic4-3">4.3</a> кроме таблицы Поставщики, в которой Страна зависит только от поля Город, который является частью первичного ключа (Поставщик, Город). Последнее обстоятельство приводит к проблемам при: </p>
<p align="justify"><ul>
<li>включении данных (пока не появится поставщик из Вильнюса, нельзя зафиксировать, что этот город Литвы),
<li>удалении данных (исключение поставщика может привести к потере информации о местонахождении города), 
<li>обновлении данных (при изменении названия страны приходится просматривать множество строк, чтобы исключить получение противоречивого результата). 
</ul></p>
<p align="justify">Разбивая эту таблицу на две таблицы Поставщики и Города (рис. <a href="3-2.htm#pic3-2">3.2</a>), можно исключить указанные аномалии.</p>
<p align="justify">Что же касается таблиц рис. <a href="4-3.htm#pic4-4">4.4</a>, то ввод в них отсутствующих  в предметной области цифровых первичных и внешних ключей формально затрудняет процедуру выявления функциональных связей между этими ключами и остальными полями. Действительно, легко установить связь между атрибутом Блюдо и Вид (блюда): Харчо – Суп, Лобио – Закуска и т.п., но нет прямой зависимости между полями БЛ и Вид (блюда), если не помнить, что значение БЛ соответствует номеру блюда.</p>
<p align="justify">Для упрощения нормализации подобных таблиц целесообразно использовать следующую рекомендацию.</p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify"><b>Рекомендация</b>. При проведении нормализации таблиц, в которые введены цифровые (или другие) заменители составных и (или) текстовых первичных и внешних ключей, следует хотя бы мысленно подменять их на исходные ключи, а после окончания нормализации снова восстанавливать.</p>
</td></tr></table>
<p align="justify">При использовании этой рекомендации таблицы рис. <a href="4-3.htm#pic4-4">4.4</a> временно превращаются в таблицы рис. <a href="4-3.htm#pic4-3">4.3</a>, а после выполнения нормализации и восстановления полей БЛ, ПР и ПОС – в нормализованные таблицы рис. <a href="3-2.htm#pic3-2">3.2</a>.</p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify">Таблица находится в <i>третьей нормальной форме</i> (<i>3НФ</i>), если она удовлетворяет определению 2НФ и не одно из ее неключевых полей не зависит функционально от любого другого неключевого поля. </p>
</td></tr></table>
<p align="justify">После разделения таблицы Поставщики рис. <a href="4-3.htm#pic4-3">4.3</a> на две части все таблицы этого проекта удовлетворяют определению 2НФ, а так как в них нет неключевых полей, функционально зависящих друг от друга, то все они находятся в 3НФ.</p>
<p align="justify">Как ни странно, этого нельзя сказать об аналогичных таблицах рис <a href="4-3.htm#pic4-4">4.4</a>. Если забыть рекомендацию о подмене на время нормализации ключей БЛ, ПР и ПОС на Блюдо, Продукт и (Поставщик, Город), то среди этих таблиц появятся две, не удовлетворяющие определению 3НФ. Действительно, так как после ввода первичных ключей БЛ и ПР поля Блюдо и Продукт стали неключевыми – появились несуществовавшие ранее функциональные зависимости между неключевыми полями:</p>
<pre>
Блюдо->Вид и Продукт->Калорийность.
</pre>
<p align="justify">Следовательно, для приведения таблиц Блюда и Продукты рис. <a href="4-3.htm#pic4-4">4.4</a> к 3НФ их надо разбить на</p>
<pre>
Блюда(<u>БЛ</u>, Блюдо),
Вид_блюда(<u>БЛ</u>, Вид);
Продукты(<u>ПР</u>, Продукт);
Калор_прод(<u>ПР</u>,Калорийносить),
</pre>
<p align="justify">хотя интуиция подсказывает, что это лишнее разбиение, совсем не улучшающее проекта базы данных.</p>
<p align="justify">Столкнувшись с подобными несуразностями, которые могут возникать не только из-за введения кодированных первичных ключей, теоретики реляционных систем Кодд и Бойс обосновали и предложили более строгое определение для 3НФ, которое учитывает, что в таблице может быть несколько <i>возможных</i> ключей.</p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify">Таблица находится в <i>нормальной форме Бойса-Кодда</i> (<i>НФБК</i>), если и только если любая функциональная зависимость между его полями сводится к полной функциональной зависимости от <i>возможного</i> ключа.</p>
</td></tr></table>
<p align="justify">В соответствие с этой формулировкой таблицы Блюда и Продукты рис. <a href="4-3.htm#pic4-4">4.4</a>, имеющие по паре возможных ключей (БЛ и Блюдо) и (ПР и Продукт) находятся в НФБК или в 3НФ. </p>
<p align="justify">В следующих нормальных формах (4НФ и 5НФ) учитываются не только функциональные, но и многозначные зависимости между полями таблицы. Для их описания познакомимся с понятием полной декомпозиции таблицы. </p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify"><a name="decomp"></a><i>Полной декомпозицией таблицы</i> называют такую совокупность произвольного числа ее проекций, соединение которых полностью совпадает с содержимым таблицы. </p>
</td></tr></table>
<p align="justify">Например, естественным соединением (см. п. <a href="3-3.htm">3.3</a>) таблиц рис. <a href="4-3.htm#pic4-3">4.3</a> можно образовать исходную таблицу, приведенную на рис. <a href="4-2.htm#pic4-2">4.2</a>. Ту же таблицу можно получить композицией таблиц рис. <a href="3-2.htm#pic3-2">3.2</a>. Следовательно, таблицы рис. <a href="4-3.htm#pic4-3">4.3</a>, <a href="4-3.htm#pic4-4">4.4</a> и <a href="3-2.htm#pic3-2">3.2</a> являются полными декомпозициями таблицы Питание рис. <a href="4-2.htm#pic4-2">4.2</a>.</p>
<p align="justify">Теперь можно дать определения высших нормальных форм. И сначала будет дано определение для последней из предложенных – 5НФ. </p>
<table cellpadding=5 border=0 bgcolor="#FFE0E0" width="100%"><tr><td>
<p align="justify">Таблица находится в <i>пятой нормальной форме</i> (<i>5НФ</i>) тогда и только тогда, когда в каждой ее полной декомпозиции все проекции содержат возможный ключ. Таблица, не имеющая ни одной полной декомпозиции, также находится в 5НФ. </p>
</td></tr></table>
<p align="justify"><i>Четвертая нормальная форма</i> (<i>4НФ</i>) является частным случаем 5НФ, когда полная декомпозиция должна быть соединением ровно двух проекций. Весьма не просто подобрать реальную таблицу, которая находилась бы в 4НФ, но не была бы в 5НФ.</p>
<p align="center">
<font size=-1>
[<a href="4-4.htm">Назад</a>] [<a href="index.htm">Содержание</a>] [<a href="4-6.htm">Вперед</a>]
</font>
</p>
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>